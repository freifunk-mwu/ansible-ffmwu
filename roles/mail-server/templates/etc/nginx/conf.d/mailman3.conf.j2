#
# {{ ansible_managed }}
#
upstream mailman3 {
      server unix://{{ mailman3_django_project_dir }}/run/uwsgi.sock fail_timeout=0;
}

server {
      listen 443 ssl http2;
      keepalive_timeout 70;

      server_name {{ mailman3_site_domain }};

      access_log  /var/log/nginx/mailman.access.log;
      error_log /var/log/nginx/mailman.error.log;

      ssl_certificate     /etc/nginx/ssl/{{ inventory_hostname }}/fullchain.pem;
      ssl_certificate_key /etc/nginx/ssl/{{ inventory_hostname }}/privkey.pem;

      location /static/ {
              alias {{ mailman3_django_project_static_dir }}/;
      }

      location / {
              include uwsgi_params;
              uwsgi_pass mailman3;
      }
}

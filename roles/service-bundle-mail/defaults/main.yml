---
# General Variables
mail_domains:
  - "freifunk-mwu.de"
  - "lists.freifunk-mwu.de"
  - "freifunk-wiesbaden.de"
  - "freifunk-mainz.de"

dkim_selector: "2019"

virtualenv_root: "/opt/venvs"

dbuser_root_password: "{{ lookup('passwordstore', 'morchel/mysql/root subkey=secret') }}"

apt_repo_gpg_rspamd: "https://rspamd.com/apt-stable/gpg.key"
apt_repo_url_rspamd:
  - "deb [arch=amd64] http://rspamd.com/apt-stable/ {{ ansible_distribution_release }} main"
  - "deb-src [arch=amd64] http://rspamd.com/apt-stable/ {{ ansible_distribution_release }} main"

apt_repo_gpg_dovecot: "https://repo.dovecot.org/DOVECOT-REPO-GPG"
apt_repo_url_dovecot:
  - "deb https://repo.dovecot.org/ce-2.3-latest/debian/{{ ansible_distribution_release }} {{ ansible_distribution_release }} main"

# Modoboa Variables
modoboa_user: "modoboa"
modoboa_group: "modoboa"
modoboa_venv_dir: "{{ virtualenv_root }}/modoboa"
modoboa_root_dir: "/opt/modoboa"
modoboa_instance_name: "ffmwu"
modoboa_instance_dir: "{{ modoboa_root_dir }}/{{ modoboa_instance_name }}"

db_modoboa: "modoboa"
dbuser_modoboa: "modoboa"
dbuser_modoboa_password: "{{ lookup('passwordstore', 'morchel/mysql/modoboa subkey=secret') }}"

modoboa_version: "1.13.1"
modoboa_dmarc_version: "1.1.0"
modoboa_sievefilters_version: "1.4.2"
modoboa_stats_version: "1.4.1"
modoboa_webmail_version: "1.5.0"

modoboa_secret_key: "{{ lookup('passwordstore', 'morchel/modoboa/secret_key subkey=secret') }}"
modoboa_debug_mode: False

# Rspamd Variables
rspamd_user: "_rspamd"
rspamd_group: "_rspamd"

rspamd_action_threshold_reject: 13
rspamd_action_threshold_addheader: 6
rspamd_action_threshold_greylist: 3
rspamd_action_threshold_rewritesubject: "null"

# Postfix Variables
dbuser_postfix: "postfix"
dbuser_postfix_password: "{{ lookup('passwordstore', 'morchel/mysql/postfix subkey=secret') }}"

postfix_map_tables:
  - "access_helo.btree"
  - "access_recipient.btree"
  - "access_recipient-rfc.btree"
  - "access_sender.btree"
  - "relay_domains.btree"
  - "relocated_maps.btree"
  - "transport_maps.btree"
  - "virtualdomain_maps.btree"

# Dovecot Variables
dovecot_virtual_user_name: "vmail"
dovecot_virtual_group_name: "vmail"
dovecot_virtual_user_uid: 4242
dovecot_virtual_group_gid: 4242
dovecot_virtual_user_home: "/srv/imap"
dbuser_dovecot: "dovecot"
dbuser_dovecot_password: "{{ lookup('passwordstore', 'morchel/mysql/dovecot subkey=secret') }}"

# Mailman3 Variables
mailman3_debug_mode: False
mailman3_core_version: "3.3.0"
mailman3_hyperkitty_version: "1.1.0"
postorius_version: "1.3.0"
hyperkitty_version: "1.3.0"
django_minimum_version: "1.11"

mailman3_site_domain: "lists.{{ mail_domain }}"
mailman3_root_dir: "/opt/mailman3"
mailman3_core_dir: "{{ mailman3_root_dir }}/core"
mailman3_venv_dir: "{{ virtualenv_root }}/mailman3"
mailman3_etc_dir: "{{ mailman3_core_dir }}/etc"
mailman3_var_dir: "{{ mailman3_core_dir }}/var"
mailman3_log_dir: "{{ mailman3_core_dir }}/log"
mailman3_django_dir: "{{ mailman3_root_dir }}/web"
mailman3_django_project_dir: "{{ mailman3_django_dir }}/project"
mailman3_django_project_static_dir: "{{ mailman3_django_project_dir }}/static"
mailman3_django_project_log_dir: "{{ mailman3_django_project_dir }}/logs"
mailman3_user: "mailman3"
mailman3_group: "mailman3"
mailman3_web_user: "nginx"
mailman3_web_group: "nginx"

mailman3_core_api_hostname: "localhost"
mailman3_core_api_port: "8001"

mailman3_postorius_root: "postorius/"
mailman3_hyperkitty_root: "hyperkitty/"

mailman3_secret_key: "{{ lookup('passwordstore', 'morchel/mailman/secret_key subkey=secret') }}"
mailman3_core_api_admin_user: "restadmin"
mailman3_core_api_admin_pass: "{{ lookup('passwordstore', 'morchel/mailman/restapi_pass subkey=secret') }}"
mailman3_archiver_key: "{{ lookup('passwordstore', 'morchel/mailman/archiver_key subkey=secret') }}"

mailman3_django_superusers:
  - name: "Freifunk MWU Admins"
    email: "mailman@{{ mail_domain }}"
    pass: "{{ lookup('passwordstore', 'morchel/mailman/django_superuser subkey=secret') }}"
